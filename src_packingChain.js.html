<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: src/packingChain.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: src/packingChain.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * @module packingChain
 */

const { Package, PackageNotEnoughSpace } = require('./package');

class PackingChain {
    /**
     * Initiate a new PackingChain instance
     * @param {Number} packageCapacity - The capacity of all package in the chain
     * @param {String} packageSpacer   - How to separate packages in the truck
     */
    constructor (packageCapacity, packageSpacer) {
        /**
         * The capacity of all package in this chain instance
         * @name PackingChain#packageCapacity
         * @type Number
         * @readonly
         */
        this.packageCapacity = packageCapacity;
        /**
         * The delimiter between packages in the chain instance truck
         * @name PackingChain#packageSpacer
         * @type String
         * @readonly
         */
        this.packageSpacer = packageSpacer;
        /**
         * All the packages handled by this instance
         * @name PackingChain#packages
         * @type Array&lt;Package>
         * @readonly
         */
        this.packages = [];
    }

    /**
     * Fill packages with things
     * @example
     * const chain = new PackingChain(10, '/');
     * chain.pack([1, 2, 4], [5, 6, 7]);
     * @param {...Array&lt;Number>} - The things to pack
     * @returns {Array&lt;Package>} - The packages, as full as possible
     * @throws {Error}           - If an unknown error occurs
     */
    pack () {
        let things = [...arguments].reduce((prev, current) => prev.concat(current), []);
        // start with bigger things since there are likely to almost fill the package
        things = things.sort((n1, n2) => n2 - n1);
        for (let thing of things) {
            let stored = false;
            for (let cursor = this.packages.length - 1 ; cursor >= 0; cursor--) {
                let pkg = this.packages[cursor];
                try {
                    pkg.add(thing);
                    stored = true;
                    break;
                } catch (e) {
                    if (e instanceof PackageNotEnoughSpace) continue;
                    else {
                        throw new Error('💥 Something went really wrong with your packages!');
                    }
                }
            }
            // this will also handle the creation of the first package in the chain
            if (!stored) {
                let pkg = new Package(this.packageCapacity);
                this.packages.push(pkg);
                pkg.add(thing);
            }
        }
        return this.packages;
    }

    /**
     * Send the packages to the customers in a 🚚
     * Packages will be separated by the instance packageSpacer
     * @example
     * const chain = new PackingChain(10, '/');
     * chain.pack(9, 8, 7);
     * chain.ship();
     * // ➡️ 9/8/7
     * @returns {String} - 📦 in the 🚚
     */
    ship () {
        let delivery = this.packages.map(pkg => pkg.content.join(''));
        delivery = delivery.join(this.packageSpacer);
        return delivery;
    }

    /**
     * Remove all the packages for this chain, for a fresh start
     * @returns {PackingChain} - Your PackingChain instance
     */
    clear () {
        this.packages.length = 0;
        return this;
    }
}

/**
 * Create a new packing chain
 */
module.exports = PackingChain;
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-package.html">package</a></li><li><a href="module-packingChain.html">packingChain</a></li></ul><h3>Classes</h3><ul><li><a href="module-packingChain-PackingChain.html">PackingChain</a></li><li><a href="Package.html">Package</a></li><li><a href="PackageNotEnoughSpace.html">PackageNotEnoughSpace</a></li></ul><h3>Global</h3><ul><li><a href="global.html#processFile">processFile</a></li><li><a href="global.html#runPackingChain">runPackingChain</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.5.5</a> on Mon Nov 27 2017 15:21:17 GMT+0000 (UTC)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
